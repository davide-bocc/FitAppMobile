pluginManagement {
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
        maven { url = uri("https://www.jitpack.io") }
        maven { url = uri("https://maven.google.com") } // Google Maven repo per Fresco e Google libs
    }
}

includeBuild("$rootDir/../node_modules/@react-native/gradle-plugin")

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.PREFER_SETTINGS)
    repositories {
        google()
        mavenCentral()
        // React Native local Maven repo per dipendenze AAR
        maven { url = uri("$rootDir/../node_modules/react-native/android") }
        maven { url = uri("https://www.jitpack.io") }
        maven { url = uri("https://oss.sonatype.org/content/repositories/snapshots/") }
        maven { url = uri("https://maven.google.com") }
    }
    versionCatalogs {
        customLibs {
            from(files("gradle/libs.versions.toml"))
        }
    }
}

rootProject.name = "FitApp"

include(":app")

// React Native come modulo locale
//include(":ReactAndroid")
//project(":ReactAndroid").projectDir = file("../node_modules/react-native/ReactAndroid")

include(":packages:react-native:ReactAndroid")
project(":packages:react-native:ReactAndroid").projectDir = file("../node_modules/react-native/packages/react-native/ReactAndroid")

apply from: file("../node_modules/@react-native-community/cli-platform-android/native_modules.gradle")
applyNativeModulesSettingsGradle(settings)

def includeIfExists(String moduleName, String relativePath) {
    def moduleDir = new File("${rootDir}/../node_modules/${relativePath}")
    if (moduleDir.exists()) {
        include(":${moduleName}")
        project(":${moduleName}").projectDir = moduleDir
    }
}

includeIfExists("react-native-vector-icons", "react-native-vector-icons/android")
includeIfExists("react-native-gesture-handler", "react-native-gesture-handler/android")
includeIfExists("react-native-reanimated", "react-native-reanimated/android")

// Firebase come moduli locali, se installati
includeIfExists("react-native-firebase_app", "@react-native-firebase/app/android")
includeIfExists("react-native-firebase_auth", "@react-native-firebase/auth/android")
includeIfExists("react-native-firebase_firestore", "@react-native-firebase/firestore/android")

include(":react-native-sqlite-storage")
project(":react-native-sqlite-storage").projectDir = new File(rootProject.projectDir, "../node_modules/react-native-sqlite-storage/platforms/android")


